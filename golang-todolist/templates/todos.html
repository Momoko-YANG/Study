<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç®¡ç†æ‚¨çš„æ‰€æœ‰å¾…åŠäº‹é¡¹">
    
    <!-- PWA ç›¸å…³ -->
    <link rel="manifest" href="/static/manifest.json">
    <meta name="theme-color" content="#667eea">
    
    <title>æˆ‘çš„ä»»åŠ¡ - Go Todo åº”ç”¨</title>
    
    <!-- æ ·å¼ -->
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <header class="header">
            <h1>ğŸ“‹ æˆ‘çš„ä»»åŠ¡</h1>
            <p>ç®¡ç†æ‚¨çš„æ‰€æœ‰å¾…åŠäº‹é¡¹</p>
            
            <!-- å¯¼èˆª -->
            <nav class="nav">
                <a href="/">é¦–é¡µ</a>
                <a href="/logout">ç™»å‡º</a>
            </nav>
        </header>

        <!-- å·¥å…·æ  -->
        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                <!-- æœç´¢æ¡† -->
                <div style="flex: 1; min-width: 200px;">
                    <input type="text" id="searchInput" placeholder="æœç´¢ä»»åŠ¡..." class="form-control" style="margin: 0;">
                </div>
                
                <!-- ç­›é€‰å™¨ -->
                <div>
                    <select id="filterSelect" class="form-control" style="width: auto; margin: 0;">
                        <option value="all">æ‰€æœ‰ä»»åŠ¡</option>
                        <option value="pending">è¿›è¡Œä¸­</option>
                        <option value="completed">å·²å®Œæˆ</option>
                    </select>
                </div>
                
                <!-- æ–°å»ºæŒ‰é’® -->
                <div>
                    <a href="/todos/new" class="btn btn-primary">+ æ–°å»ºä»»åŠ¡</a>
                </div>
            </div>
        </div>

        <!-- ä»»åŠ¡åˆ—è¡¨ -->
        <div class="card">
            <div id="todoList" class="todo-list">
                {{range .Todos}}
                <div class="todo-item {{if .Completed}}completed{{end}} fade-in">
                    <div class="todo-title">{{.Title}}</div>
                    <div class="todo-description">{{.Description}}</div>
                    <div class="todo-meta">
                        <span class="status-badge {{if .Completed}}status-completed{{else}}status-pending{{end}}">
                            {{if .Completed}}å·²å®Œæˆ{{else}}è¿›è¡Œä¸­{{end}}
                        </span>
                        <span>{{.CreatedAt.Format "2006-01-02 15:04"}}</span>
                    </div>
                    <div class="todo-actions">
                        <a href="/todos/{{.ID}}" class="btn btn-secondary">æŸ¥çœ‹</a>
                        <a href="/todos/{{.ID}}/edit" class="btn btn-primary">ç¼–è¾‘</a>
                        <form method="POST" action="/todos/{{.ID}}/delete" style="display: inline;">
                            <button type="submit" class="btn btn-danger" onclick="return confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä»»åŠ¡å—ï¼Ÿ')">åˆ é™¤</button>
                        </form>
                    </div>
                </div>
                {{else}}
                <div class="empty-state">
                    <h3>æš‚æ— ä»»åŠ¡</h3>
                    <p>ç‚¹å‡»"æ–°å»ºä»»åŠ¡"æŒ‰é’®å¼€å§‹åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªä»»åŠ¡</p>
                    <a href="/todos/new" class="btn btn-primary" style="margin-top: 15px;">åˆ›å»ºç¬¬ä¸€ä¸ªä»»åŠ¡</a>
                </div>
                {{end}}
            </div>
        </div>

        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
        <div class="card">
            <h3>ä»»åŠ¡ç»Ÿè®¡</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-top: 15px;">
                <div style="text-align: center; padding: 15px; background: rgba(102, 126, 234, 0.1); border-radius: 10px;">
                    <div style="font-size: 2rem; font-weight: bold; color: #667eea;">{{len .Todos}}</div>
                    <div>æ€»ä»»åŠ¡æ•°</div>
                </div>
                <div style="text-align: center; padding: 15px; background: rgba(255, 193, 7, 0.1); border-radius: 10px;">
                    <div style="font-size: 2rem; font-weight: bold; color: #d69e2e;">
                        {{$pending := 0}}{{range .Todos}}{{if not .Completed}}{{$pending = add $pending 1}}{{end}}{{end}}{{$pending}}
                    </div>
                    <div>è¿›è¡Œä¸­</div>
                </div>
                <div style="text-align: center; padding: 15px; background: rgba(72, 187, 120, 0.1); border-radius: 10px;">
                    <div style="font-size: 2rem; font-weight: bold; color: #38a169;">
                        {{$completed := 0}}{{range .Todos}}{{if .Completed}}{{$completed = add $completed 1}}{{end}}{{end}}{{$completed}}
                    </div>
                    <div>å·²å®Œæˆ</div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
    <div id="loading" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000;">
        <div class="loading"></div>
    </div>

    <!-- JavaScript -->
    <script src="/static/js/app.js"></script>
    
    <!-- é¡µé¢ç‰¹å®šè„šæœ¬ -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ä»»åŠ¡åˆ—è¡¨é¡µé¢å·²åŠ è½½');
            
            // æ·»åŠ é”®ç›˜å¿«æ·é”®
            document.addEventListener('keydown', function(e) {
                // Ctrl/Cmd + N: æ–°å»ºä»»åŠ¡
                if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                    e.preventDefault();
                    window.location.href = '/todos/new';
                }
                
                // Ctrl/Cmd + F: æœç´¢
                if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                    e.preventDefault();
                    const searchInput = document.getElementById('searchInput');
                    if (searchInput) {
                        searchInput.focus();
                    }
                }
            });
            
            // æ·»åŠ ä»»åŠ¡é¡¹æ‚¬åœæ•ˆæœ
            const todoItems = document.querySelectorAll('.todo-item');
            todoItems.forEach(item => {
                item.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-3px)';
                });
                
                item.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });
        });
    </script>
</body>
</html>
